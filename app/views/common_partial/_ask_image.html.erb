<div id="ask_image_bg" onclick="ask_image_off(); return false;" style="position:fixed; top:0; left:0; width:100%; height:100%; background-color:#000; z-index:12; opacity:0.75; display:none;"></div>
<div id="ask_image_overlay" style="position:fixed; top:0; width:inherit; height:100%; display:table; z-index:13; display:none;">
  <a href="#" onclick="ask_image_off(); return false;" style="position:fixed; top:0; left:0; width:100%; display:block; text-align:right;">
    <i class="fa fa-times" style="color: #fff; width: 50px; font-size: 30px; text-align: center; padding: 10px 0;"></i>
  </a>
  <div style="display:table; width:100%; height:100%;">
    <div style="display:table-cell; text-align:center; vertical-align:middle;">
      <div id="ask_image_seg" style="padding:12px; display:inline-block;"></div>
    </div>
  </div>

</div>


<script type="text/template" id="ask-image-seg-template">
  {{ if (is_left){ }}
    {{ ask_deal = ask.left_ask_deal }}
    {{ left_css = "color:#ee6e01; font-weight:bold; font-size:16px; border-bottom:3px solid #ee6e01; height:42px; line-height:42px;" }}
    {{ right_css = "color:#fff; font-size:16px; height:42px; line-height:42px;" }}
  {{ }else{ }}
    {{ ask_deal = ask.right_ask_deal }}
    {{ left_css = "color:#fff; font-size:16px; height:42px; line-height:42px;" }}
    {{ right_css = "color:#ee6e01; font-weight:bold; font-size:16px; border-bottom:3px solid #ee6e01; height:42px; line-height:42px;" }}
  {{ } }}

  <table cellspacing="0" cellpadding="0" style="width:100%; overflow:visible; height:42px;">
    <tr>
      <td style="width:50%;">
        <a href="#" onclick="ask_image_on({{=ask.id}}, true); return false;" style="width:100%; display:block; {{= left_css }} ">
          CARD A
        </a>
      </td>
      <td style="width:50%;">
        <a href="#" onclick="ask_image_on({{=ask.id}}, false); return false;" style="width:100%; display:block; {{= right_css }}">
          CARD B
        </a>
      </td>
    </tr>
  </table>
  <img src='{{= get_image_url(ask_deal, "ask_deals", "normal") }}' style="width:100%; display:block; border-radius:10px 10px 0 0;" />
  <div style="padding:10px 10px 5px; border-radius:0 0 10px 10px; font-size:13px; color:#666; background-color:#f4f4f4;">
    <p style="margin:5px auto; font-weight:bold;">
      {{= ask_deal.title }}
    </p>
    <p style="margin:5px auto; font-weight:normal;">
      {{= ask_deal.brand }}
    </p>
    <p style="margin:5px auto; font-weight:normal;">
      {{= numberWithCommas(ask_deal.price) }}Ïõê
    </p>
    <p style="margin:5px auto; font-weight:normal;">
      {{ var aLink = document.createElement("a") }}
      {{ aLink.href= ask_deal.link }}
      <i class="fa fa-external-link" style="color: #ee6e01; font-size: 12px; font-weight: bold;"></i>&nbsp;<a href="{{=ask_deal.link }}" target="_blank" style="color:#ee6e01;">{{= aLink.host }}</a>
    </p>
  </div>
</script>

<script>
  function ask_image_on(ask_id, is_left){
    disableScroll();
    $("#ask_image_overlay").show();
    $("#ask_image_bg").show();

    var ask = $.grep(asks, function(obj) { return obj.id === ask_id })[0];
    var askImageSegTemplate = _.template($('#ask-image-seg-template').html());
    $("#ask_image_seg").html(askImageSegTemplate({ask:ask, is_left:is_left}));
  }

  function ask_image_off(){
    enableScroll();
    $("#ask_image_overlay").hide();
    $("#ask_image_bg").hide();
  }

</script>
