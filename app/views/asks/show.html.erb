<%= render :partial => "common_partial/header", :locals => {:title => ""} %>
<div id="asks" class="table_div"></div>
<%= render :partial => "common_partial/asks" %>
<%= render :partial => "common_partial/ask_image" %>
<%= render :partial => "common_partial/more_popup" %>
<%= render :partial => "common_partial/share_popup" %>

<script>
  show_detail_vote_count(ask.id);
  $("#ask_deal_"+ask.id+"_table").html(askDealTableTemplate({ask: ask}));
  tooltip_box(ask.id);
  $("#ask_"+ask.id+"_message_more").click();
  $("#ask_"+ask.id+"_comment").html(askCommentTemplate({ask: ask}));
  for (i=0; i<ask.comments.length; i++) {
    var comment = ask.comments[i];
    link_tagging(comment.content, $('#comment_content_'+comment.id+' .comment_content'), true);
  };
  comment_input_setting(ask.id, ask.user);
  $("#ask_"+ask.id+"_detail_btn").remove();
  $("#detail_vote_count_"+ask.id+", #ask_deal_"+ask.id+"_table, #ask_"+ask.id+"_comment").show();


  history.pushState(null, null, null);
  $(window).bind("hashchange", function(){
		if (is_ask_image_opened) {
			ask_image_off();
		// } else if (is_category_opened) {
		// 	category_off();
		} else if (is_user_setting_opened) {
			manage_off();
		} else if (is_user_opened) {
			user_off();
		// } else if (is_search_input_opened) {
		// 	search_input_off();
		} else if (is_share_popup_opened) {
			hide_share_popup();
		} else if (is_more_popup_opened) {
			hide_more_popup();
		// } else if (is_card_opened) {
		// 	card_detail_off(opened_ask_id);
		}	else {
			return false;
		}
	});
  $(document).keydown(function(e){
		if(e.target.nodeName != "INPUT" && e.target.nodeName != "TEXTAREA"){
			if(e.keyCode === 27){
				if (is_ask_image_opened) {
					history.back();
				// } else if (is_category_opened) {
				// 	history.back();
				} else if (is_user_setting_opened) {
					history.back();
				} else if (is_user_opened) {
					history.back();
				// } else if (is_search_input_opened) {
				// 	history.back();
				} else if (is_share_popup_opened) {
					history.back();
				} else if (is_more_popup_opened) {
					history.back();
				// } else if (is_card_opened) {
				// 	history.back();
				}	else {
					return false;
				}
			}
		}
	});
</script>
